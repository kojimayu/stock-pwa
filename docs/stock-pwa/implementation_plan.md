# 「カテゴリー小（商品タイプ）」の実装

## 実装の目的
「化粧カバー（屋外用）」のように登録商品数が非常に多いカテゴリーにおいて、より細かく商品を分類して管理しやすくするため、第3の分類階層として **「カテゴリー小（商品タイプ）」** を実装します。
これにより、以下のようなドリルダウン絞り込みが可能になります。
*   分類例: `カテゴリー大（化粧カバー）` -> `カテゴリー中（屋外用）` -> **`カテゴリー小（直管 / コーナー / ジョイント / その他）`**

## ユーザー確認事項
> [!WARNING]
> この変更には**データベースの変更（スキーマ変更）**が必要です。
>
> `Product`（商品）テーブルに、新たに `productType`（カテゴリー小）という項目を追加します。

*   既存の登録済みデータについて、この項目は最初は「空（null）」の状態になります。
*   実装後、必要に応じて商品編集画面から登録するか、将来的には商品名からの一括自動設定などを検討する必要があります。

## 変更内容詳細

### データベース (Prisma)
#### [MODIFY] [schema.prisma](file:///f:/Antigravity/stock-pwa/prisma/schema.prisma)
- `Product` モデルに `productType String?` を追加します。

### 管理画面 UI (Admin UI)
#### [MODIFY] [product-dialog.tsx](file:///f:/Antigravity/stock-pwa/components/admin/product-dialog.tsx)
- 商品情報の登録・編集ダイアログに、「カテゴリー小」の入力欄（セレクトボックス等）を追加します。
- フォームの バリデーション（検証）ルールと送信処理を更新します。

#### [MODIFY] [product-list.tsx](file:///f:/Antigravity/stock-pwa/components/admin/product-list.tsx)
- 商品一覧テーブルに「カテゴリー小」の表示を追加（または備考欄などに併記）します。
- 一覧上部に「カテゴリー小」用の絞り込みドロップダウンを追加します。
    - カテゴリー（大）→（中）を選択した際に、連動して選択肢が切り替わるようにします。

#### [MODIFY] [actions.ts](file:///f:/Antigravity/stock-pwa/lib/actions.ts)
- 商品作成 (`createProduct`) および更新 (`updateProduct`) のサーバー側処理で、`productType` を保存できるように更新します。

## 検証計画
1.  **マイグレーション**: `npx prisma migrate dev` を実行し、データベース構造が正しく変更されること、および既存データが消えないことを確認します。
2.  **商品登録**: テスト商品を新規作成し、大・中・小すべてのカテゴリーが正しく保存されることを確認します。
3.  **商品編集**: 既存の商品を編集し、「カテゴリー小」を追加登録できることを確認します。
4.  **絞り込み動作**: 商品一覧画面で、大→中→小の順にフィルターを選択し、意図通りに商品が絞り込まれることを確認します。
