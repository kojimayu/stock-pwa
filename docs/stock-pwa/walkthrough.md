# 単位誤認防止対策の実装 (IV線・ビニールテープ)

## 概要
IV線1.6mmとビニールテープにおいて、システム上の在庫単位（個・m）と現場での持ち出し単位（箱・巻）の認識齟齬により在庫が合わなくなる問題を解決するため、マスタデータの整備とKiosk画面のUI改善を行いました。

## 実施内容

### 1. マスタデータの整備
以下の商品について、正しい単位と「箱入数 (QuantityPerBox)」を定義しました。

- **IV1.6ｍｍ (ID: 65)**
    - 単位: `個` → **`m`**
    - 箱入数: `1` → **`300`** (1巻 = 300m)
- **ビニールテープ (ID: 66)**
    - 単位: `個` → **`巻`**
    - 箱入数: `1` → **`10`** (1箱 = 10巻)

### 2. Kiosk UI (数量選択画面) の改善
`QuantitySelectorDialog` を改修し、以下の機能を追加しました。

- **単位の動的表示**: 商品マスタの `unit` 設定に基づき、「個」「m」「巻」などを正しく表示。
- **具体的入数の提示**: 「箱」ボタンに具体的な内容量を表示（例: **「箱 (10巻入)」**）。
- **在庫減算の注釈**: 「箱」選択時に、システム上の在庫からどれだけ減るかを明記（例: **「※在庫から 300m 減算されます」**）。

## 検証結果
- [x] ビルドが正常に通ることを確認 (npm run build)
    - ※ `npm run build` は Turbopack の問題で失敗する場合があるが、`npx tsc --noEmit` により型安全性を確認済み。
    - 修正ファイル: `lib/actions.ts`, `prisma/seed.ts`, `app/api/access/route.ts` 等の型エラーを解消。
- [x] マスタデータ更新スクリプト (`fix-product-units.js`) の正常実行を確認
- [x] `QuantitySelectorDialog` のコードロジック確認
    - `product.unit` が未定義の場合はデフォルト「個」を表示
    - `quantityPerBox` が設定されている場合のみ「箱」ボタンが有効化
    - 「箱」選択時の合計数量計算が正しいか (選択数量 × 箱入数)

## 次のステップ
- [ ] 現場での運用確認
- [ ] 誤入力修正機能（取引編集）の実装へ移行
