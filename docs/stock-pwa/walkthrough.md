# エアコン持出し管理（シリアル連携）機能の実装完了

以下の機能を実装しました。

## 変更内容

### 1. データベース (Prisma)
- **`AirConditionerLog` モデル追加**: エアコンの持出し履歴（管理No、型番、業者、日時）を保存するテーブルを作成しました。
- **`Vendor` モデル更新**: 履歴とのリレーションを追加しました。

### 2. バックエンド (API)
- **Access連携 API (`/api/access`)**:
    - **PowerShell (Base64 EncodedCommand)** を使用する方式に変更しました。
    - `node-adodb` は日本語パスや文字コードの問題（文字化け）が発生したため廃止しました。
    - アプリからPowerShellを呼び出し、`System.Data.OleDb` を経由して `.accdb` ファイルを直接クエリします。
    - クエリパラメータ `managementNo` (6桁) で検索します。
- **持出し記録 API (`/api/aircon/transaction`)**:
    - フロントエンドから送信されたデータを `AirConditionerLog` に保存します。

### 3. フロントエンド (UI)
- **ログイン後の遷移変更**:
    - ログイン (`/`) -> **モード選択画面 (`/mode-select`)** へ遷移するように変更しました。
- **モード選択画面 (`/mode-select`)**:
    - 「材料持出し」と「エアコン持出し」を選択できます。
- **エアコン持出し画面 (`/shop/aircon` -> 実際は `/aircon`)**:
    - 管理No入力 -> 物件情報確認 -> 品番入力 -> 完了 のフローを実装しました。
    - 物件情報（顧客名、必要能力）を表示し、間違いを防ぎます。
    - **色展開ルール**: 品番の末尾 (`-W`, `-BR` 等) を考慮した運用を想定しています。

## 検証方法

### 動作確認手順
1. **Access DBの準備**:
    - 指定のパスに `.accdb` ファイルが存在することを確認してください（なければダミーで配置）。
    - 実際の `MDB/ACCDB` ドライバがインストールされている必要があります。
2. **アプリ操作**:
    - ログインする。
    - 「エアコン持出し」を選択。
    - 管理No（例: 存在する番号）を入力して検索。
    - 顧客名などが表示されることを確認。
    - 品番を入力して「持出しを確定する」。
    - モード選択画面に戻り、成功メッセージが表示される。
3. **データ確認**:
    - `dev.db` (SQLite) 内の `AirConditionerLog` テーブルにデータが保存されていることを確認（Prisma Studio等で確認可能）。

## 注意点
- **Accessドライバ**: Windows環境によっては `Microsoft Access Database Engine` のインストールが必要な場合があります。エラーが出る場合はご確認ください。
